<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
        "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.seig.backend.product.mapper.CategoriesMapper">
    <select id="getAllCategories" resultType="com.seig.backend.product.entity.Categories">
        select * from medicine_categories
    </select>
<!--    <select id="getCategoriesVo" resultType="com.seig.backend.product.entity.Categories">-->
<!--        select * from medicine_categories-->
<!--    </select>-->
    <!-- 动态更新分类信息（只更新非空字段） -->
    <update id="updateCategories" parameterType="com.seig.backend.product.entity.Categories">
        UPDATE medicine_categories
        <set>
            <if test="categoryCode != null and categoryCode != ''">category_code = #{categoryCode},</if>
            <if test="categoryName != null and categoryName != ''">category_name = #{categoryName},</if>
            <if test="parentId != null">parent_id = #{parentId},</if>
            <if test="level != null">level = #{level},</if>
            <if test="fullPath != null and fullPath != ''">full_path = #{fullPath},</if>
            <if test="description != null">description = #{description},</if>
            <if test="sortOrder != null">sort_order = #{sortOrder},</if>
            <if test="status != null">status = #{status},</if>
            updated_at = NOW()
        </set>
        WHERE category_id = #{categoryId}
    </update>

    <!-- 插入新的分类 -->
    <insert id="insertCategories" parameterType="com.seig.backend.product.entity.Categories">
        INSERT INTO medicine_categories (
            category_code,
            category_name,
            parent_id,
            level,
            full_path,
            description,
            sort_order,
            status,
            created_at,
            updated_at
        ) VALUES (
                     #{categoryCode},
                     #{categoryName},
                     #{parentId},
                     #{level},
                     #{fullPath},
                     #{description},
                     #{sortOrder},
                     #{status},
                     NOW(),
                     NOW()
                 )
    </insert>

    <!-- 删除分类 -->
    <delete id="deleteCategories" parameterType="java.lang.Integer">
        DELETE FROM medicine_categories
        WHERE category_id = #{categoryId}
    </delete>
</mapper>